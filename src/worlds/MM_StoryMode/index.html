<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>
    <!-- Physics script goes after the Circles' head scripts [IMPORTANT]-->
    <script src="/global/js/libs/aframe-physics-system.min.js"></script>
    <script src="/worlds/KIN_FreeFall/components/physics-object.js"></script>
    <script src="/worlds/KIN_FreeFall/components/collision-indicator.js"></script>
    <script src="/worlds/KIN_FreeFall/scripts/experiment-functions.js"></script>
  </head>

  <body onload="setup()">
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui/>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene circles_scene_properties>

      <a-camera position="0 1.6 0" rotation="0 0 0"></a-camera>
      <!-- assets -->
      <a-assets timeout="10000">
        <!-- credit: HDRMaps @ https://hdrmaps.com/above-the-clouds/ -->
        <img id='skyMap' src='assets/images/086_hdrmaps_com_free_above_clouds.jpg' crossorigin="anonymous">

        <!-- narration, for some reason when I add this it messes with the spawn point????-->
        <audio id="Narr_welcome" src="assets/audio/narr_welcome.mp3" preload="true"></audio>
        <audio id="Narr_tools-snd" src="/worlds/WIT_2_Lab/assets/audio/Narr_WIT_2_Drill.mp3" preload="true"></audio>


        <!-- Models -->
          <a-asset-item id="majesticCamera_gltf" src="/worlds/MM_CreativeMode/assets/models/majesticCamera.gltf" response-type="arraybuffer"></a-asset-item>
          <a-asset-item id="northernElectronicsTelephone_gltf" src="/worlds/MM_CreativeMode/assets/models/northernElectricsTelephone.gltf" response-type="arraybuffer"></a-asset-item>
          <a-asset-item id="CPUTerminal_gltf" src="/worlds/MM_CreativeMode/assets/models/CPUTerminal.gltf" response-type="arraybuffer"></a-asset-item>
          <a-asset-item id="lemWood_gltf" src="/worlds/MM_CreativeMode/assets/models/lemWood.gltf" response-type="arraybuffer"></a-asset-item>
          <a-asset-item id="singerSewingMachine_gltf" src="/worlds/MM_CreativeMode/assets/models/singerSewingMachine.gltf" response-type="arraybuffer"></a-asset-item>
          <a-asset-item id="majesticCamera_gltf" src="/worlds/MM_CreativeMode/assets/models/majesticCamera.gltf" response-type="arraybuffer"></a-asset-item>
          <a-asset-item id="spaceArm_gltf" src="assets/models/spaceArm.gltf" response-type="arraybuffer"></a-asset-item>

        <!-- Environment -->
        <a-asset-item id="room_gltf" src="assets/models/room.gltf" crossorigin="anonymous"></a-asset-item>

        <!-- Images -->
          <img id='IngeniumLogo' src='assets/images/Ingenium-BI-rgb.png' crossorigin="anonymous">
          <img id='hint01' src='assets/images/ingenium_hint01.png' crossorigin="anonymous">
          <img id='hint02' src='assets/images/ingenium_hint02.png' crossorigin="anonymous">
          <img id='hint03' src='assets/images/ingenium_hint03.png' crossorigin="anonymous">
          <img id='dustSpec_img' src='assets/images/dustSpec.jpg' crossorigin="anonymous">
          

        <!-- Hub image -->
        <img id='hub360' src='/worlds/MuseumMysteriesHub/assets/images/MMHubIMG.png' crossorigin="anonymous">
        <img id='Ingenium360IMG' src='assets/images/360_Ingenium.jpg' crossorigin="anonymous">

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar/>

      

  <!-- BEAKERS -->
        <a-entity id="beaker1"
                    position="0 1.5 -12" rotation="0 0 0" scale="0.3 0.3 0.3"
                    geometry="primitive:cylinder; radiusTop: 0.3; radiusBottom: 0.4; height: 1.2; segmentsRadial: 20; openEnded: false;"
                    material="color: #FFFFFF; transparent: true; opacity: 0.8;"
                   
                    circles-artefact="inspectPosition:0 0 0; inspectRotation:0 0 0; inspectScale:0.8 0.8 0.8;
                                      textRotationY:90.0; labelLookAt:true; label_offset:0.0 1.0 0.0;  arrow_position:down;
                                      label_text: Hydrogen ;"
                    circles-pickup-networked></a-entity>    
        <a-entity id="beaker2"
                    position="-2 1.5 -12" rotation="0 0 0" scale="0.3 0.3 0.3"
                    geometry="primitive:cylinder; radiusTop: 0.3; radiusBottom: 0.4; height: 1.2; segmentsRadial: 20; openEnded: false;"
                    material="color: #FF0000; transparent: true; opacity: 0.8;"
                     
                    circles-artefact="inspectPosition:0 0 0; inspectRotation:0 0 0; inspectScale:0.8 0.8 0.8;
                    textRotationY:90.0; labelLookAt:true; label_offset:0.0 1.0 0.0;  arrow_position:down;
                    label_text: Oxygen ;"
                    circles-pickup-networked></a-entity>
        <a-entity id="beaker3"
                    position="2 1.5 -12" rotation="0 0 0" scale="0.3 0.3 0.3"
                    geometry="primitive:cylinder; radiusTop: 0.3; radiusBottom: 0.4; height: 1.2; segmentsRadial: 20; openEnded: false;"
                    material="color: blue; transparent: true; opacity: 0.8;"
                   
                    circles-artefact="inspectPosition:0 0 0; inspectRotation:0 0 0; inspectScale:0.8 0.8 0.8;
                    label_offset:0.0 1.0 0.0;  arrow_position:down;
                    label_text: Nitrogen;"
                    circles-pickup-networked></a-entity>  
        <!--PUZZLE ENTITIES-->
        <!-- PASSCODE -->
        <a-entity id="passcodeInput" click-log position="-3 1 -10.75" rotation="0 0 0" scale="1 1 1" text="value: Enter Passcode; color: #fff; width: 1.5; align: center; wrapCount: 15"></a-entity>
        <a-entity id="passcodeCursor" click-log position="-3 1 -10.75" rotation="0 0 0" scale="1 1 1" text="value: |; color: #fff; width: 1.5; align: center;"></a-entity>


      <!-- models -->
      <a-entity gltf-model="#spaceArm_gltf" 
                position="-1 -5 -6" rotation="0 0 0"
                shadow="cast:true; receive:true;"></a-entity>
      <a-entity gltf-model="#CPUTerminal_gltf" 
                position="-2 1.05 -12.65" rotation="0 180 0"
                shadow="cast:true; receive:true;"></a-entity>
      <a-entity id="phone"
                gltf-model="#northernElectronicsTelephone_gltf"
                position="1.5 1 -0.9" rotation="0 -90 0"
                circles-pickup-networked
                circles-artefact="inspectScale:1.2 1.2 1.2; textRotationY:90; inspectRotation:0 0 0; inspectPosition:0 -0.2 0;
                                  label_offset:0 0.6 0;  labelLookAt:true; descriptionLookAt:true;  arrow_position:down;
                                  title:Welcome To Your First Day On The Job; 
                                  description:\nWelcome to your first day on the job! You need to clean the artifacts so we can put them on the floor ASAP! Email me when you’re finished with the job then you’re good to go. Good luck!;
                                  title_back:Welcome To Your First Day On The Job;
                                  description_back:\n Employee Status: New Hire;
                                  label_text:Pickup Telephone;
                                  audio:#Narr_welcome; volume:0.4;"
                shadow="cast:true; receive:true;"></a-entity>  
      <a-entity obj-model="obj: #arm_obj; mtl: #arm_mtl"
                position="-20 0.05 -1.7"
                shadow="cast:true; receive:true;"></a-entity>  
      <a-entity id="cleaningArtifacts">        
        <a-entity id="artefact-sewingMachine"
                    position="5 1.15 -6" rotation="0 90 0" scale="1 1 1"
                    geometry="primitive:octahedron; radius:0.5;"
                    material="color:blue; emissive:green; emissiveIntensity:0.7; metalness:0.3; roughness:0.8;" 
                    gltf-model="#singerSewingMachine_gltf">
                    <a-entity class="button interactive"
                              id="dirtSpec_11"
                              position="0.15 0.6 -0.3"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #FFD637"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#FFD637; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>
                    <a-entity class="button interactive"
                              id="dirtSpec_12"
                              position="0.15 0.3 0.3"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #FFD637"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#FFD637; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>  
                    <a-entity class="button interactive"
                              id="dirtSpec_13"
                              position="0 0.2 0"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #FFD637"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#FFD637; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>  
          </a-entity>          
        <a-entity id="artefact-LEMwood"
                    position="9.5 1.15 -9.5" rotation="0 0 0" scale="1 1 1"
                    geometry="primitive:octahedron; radius:0.5;"
                    material="color:blue; emissive:green; emissiveIntensity:0.7; metalness:0.3; roughness:0.8;" 
                    gltf-model="#lemWood_gltf">
                    <a-entity class="button interactive"
                              id="dirtSpec_21"
                              position="-0.1 0.15 -0.1"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #C0FF37"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#C0FF37; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>
                    <a-entity class="button interactive"
                              id="dirtSpec_22"
                              position="0.1 0.05 0"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #C0FF37"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#C0FF37; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>  
                    <a-entity class="button interactive"
                              id="dirtSpec_23"
                              position="0 0 0.02"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #C0FF37"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#C0FF37; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>  </a-entity> 
        <a-entity id="artefact-camera"
                    position="5 1.15 -12.5" rotation="0 25 0" scale="1 1 1"
                    geometry="primitive:octahedron; radius:0.5;"
                    material="color:blue; emissive:green; emissiveIntensity:0.7; metalness:0.3; roughness:0.8;" 
                    gltf-model="#majesticCamera_gltf"
                    >
                    <a-entity class="button interactive"
                              id="dirtSpec_31"
                              position="0.15 0.1 -0.05"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #FFD637"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#FFD637; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>
                    <a-entity class="button interactive"
                              id="dirtSpec_32"
                              position="0 0.15 0"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #FFD637"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#FFD637; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>  
                    <a-entity class="button interactive"
                              id="dirtSpec_33"
                              position="-0.15 0.05 0.05"
                              geometry="primitive:sphere; radius:0.06"
                              material="color: #FFD637"
                              animation__mouseenter="property:material.color; type:color; to:#FFE78B; startEvents:mouseenter; dur:200"
                              animation__mouseleave="property:material.color; type:color; to:#FFD637; startEvents:mouseleave; dur:200"
                              animation__click="property:geometry.radius; from:0.04; to:0; startEvents:click; dur:300"></a-entity>  </a-entity> 
        <a-entity id="artefact-cleaningHint"
                  position="-2.25 1.5 0" rotation="0 90 0" scale="1 1 1"
                  geometry="primitive:octahedron; radius:0.25;"
                  material="color:#f29f05; emissive:green; emissiveIntensity:0.7; metalness:0.3; roughness:0.8;" 
                  circles-artefact="inspectPosition:0 0 0; inspectRotation:0 0 0; inspectScale:0.8 0.8 0.8;
                                    textRotationY:90.0; labelLookAt:true; descriptionLookAt:true; label_offset:0.0 1.0 0.0; arrow_position:down;
                                    title: Hint 01;
                                    description:Click on the coloured spheres to clean them off the artifacts;
                                    title_back: Hint 02;
                                    description_back:There are 9 spots total to clean;
                                    label_text:Cleaning Hint;"
                  circles-pickup-networked></a-entity>  
        </a-entity>
      
      <!-- Text -->
      <a-entity id="Welcome" position="2.25 2.5 1" scale="1.2 1.2 1.2" rotation="0 -90 0" text="value: “Story Mode - Solve Puzzles To Earn Your Promotion”; color: #fff; width: 1.7; wrapCount: 25; align: center; tabSize: 4.43; font: /worlds/KIN_Hub/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60"></a-entity>
      <a-entity id="Welcome" position="2.25 2 1" scale="1 1 1" rotation="0 -90 0" text="value: “Welcome to your first day on the job!\nPick up the telephone to get your task for the day\nIf you ever need help, grab a hint from the other wall”; color: #fff; width: 1.7; wrapCount: 45; align: center; tabSize: 4.43; font: /worlds/KIN_Hub/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60"></a-entity>

      <!-- hints for computor password puzzle -->
        <a-image id="passwordHint_img" src="#IngeniumLogo" position="-0.25 1.05 -12.65" rotation="-90 180 0" scale="1 0.5 1"></a-image>
        <a-image id="hint01_img" src="#hint01" position="-4 1.005 -12.4" rotation="-90 0 0" scale="2 0.5 1"></a-image>
        <a-image id="hint02_img" src="#hint02" position="-9 0.005 0" rotation="-90 90 0" scale="10 2 1"></a-image>
        <a-image id="hint03_img" src="#hint03" position="4.95 1.1 -9.35" rotation="-90 -30 0" scale="1 1 1" visible="false"><!--2 0.5 1--></a-image>

      <!-- Portal to back to MM Hub --> 
        <a-entity id="backToHubTXT" 
                  position="0 3.5 2.5" scale="1.5 1.5 1.5" rotation="0 180 0"
                  text="value: Back To Hub; color: #FFDD00; width: 3; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_Hub/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60"></a-entity>
      <a-entity id="HubLink"
            position="0 2 2.5" rotation="0 90 0" scale="1 1 1"
            circles-portal="img_src:#hub360; title_text:Click me to be teleported; text_color:black; link_url:/w/MuseumMysteriesHub"></a-entity>
            
      </a-entity>

      <!-- Checkpoints -->
      <a-entity id="CHECKPOINTS">
        <a-entity circles-checkpoint circles-spawnpoint position="0 0.05 0"></a-entity>
        <a-entity circles-checkpoint position="0 0.05 -4"></a-entity>
        <a-entity circles-checkpoint position="0 0.05 -9"></a-entity>

        <a-entity circles-checkpoint position="-1 0.05 -14"></a-entity>
        <a-entity circles-checkpoint position="3 0.05 -14"></a-entity>
        <a-entity circles-checkpoint position="7 0.05 -14"></a-entity>
        <a-entity circles-checkpoint position="11 0.05 -14"></a-entity>
        
        <a-entity circles-checkpoint position="5 0.05 -7.5"></a-entity>
        <a-entity circles-checkpoint position="5 0.05 -11"></a-entity>
        <a-entity circles-checkpoint position="9.5 0.05 -7.5"></a-entity>
        <a-entity circles-checkpoint position="9.5 0.05 -11"></a-entity>

        <a-entity circles-checkpoint position="16.5 0.05 -4.85"></a-entity>
        <a-entity circles-checkpoint position="16.5 0.05 -7.75"></a-entity>
        <a-entity circles-checkpoint position="16.5 0.05 -10.75"></a-entity>
        <a-entity circles-checkpoint position="16.5 0.05 -13.75"></a-entity>

        <a-entity circles-checkpoint position="19.5 0.05 -4.85"></a-entity>
        <a-entity circles-checkpoint position="19.5 0.05 -7.75"></a-entity>
        <a-entity circles-checkpoint position="19.5 0.05 -10.75"></a-entity>
        <a-entity circles-checkpoint position="19.5 0.05 -13.75"></a-entity>

      </a-entity>

      <!-- envir 
      <a-entity id="grass" position="0 -1 0"  geometry="primitive:box; depth:50; width:50; height:1;" material="color:#2e4230;" body="type:static; mass:0; shape:box;" circles-shadow></a-entity>
      --><a-entity id="room" 
                gltf-model="#room_gltf"
                position="0 0 0"
                shadow></a-entity>
      <a-entity light="type:ambient; color:#FFF; intensity:3.0"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 1.0" position="0 1 1"></a-entity>
      <a-entity light="type: spot; color: #FFF; intensity: 1.0" position="10 5 6" rotation="-90 0 0"></a-entity>
      <a-entity id='skyBox'
                position="0 0 -25"
                rotation='0 0 0'
                geometry='primitive:sphere; radius:55; segments-height:24; segments-width:24;'
                material='shader:flat; src:#Ingenium360IMG; side:back;'>
      </a-entity>
      <a-entity id="MMSMInstructions" position="17 0.05 -1.7" text="value: FREE FALL; color: #13446e; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_Hub/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60" scale="1.5 1.5 1.5" rotation="-90 0 0"></a-entity>
    
      

        <script src="/socket.io/socket.io.js"></script>
        <script>
          var isClean = 0;
          const toBeCleaned = 8;
          console.log(isClean);
            const socket = io();

            socket.on('connect', (userData) => {
                console.log('I exist!');

                document.querySelector('#dirtSpec_11').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });
                document.querySelector('#dirtSpec_12').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });
                document.querySelector('#dirtSpec_13').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });

                document.querySelector('#dirtSpec_21').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });
                document.querySelector('#dirtSpec_22').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });
                document.querySelector('#dirtSpec_23').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });

                document.querySelector('#dirtSpec_31').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });
                document.querySelector('#dirtSpec_32').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });
                document.querySelector('#dirtSpec_33').addEventListener('click', function(){
                    console.log('I clean!');
                    isClean++;
                    console.log(isClean);
                    if(isClean > toBeCleaned){
                      console.log("cleaningFinished!");
                      document.querySelector('#hint03_img').setAttribute('visible', true);
                    }
                });

              });

          //----------------------------------------------------------------------------------
          //----------------------------------------------------------------------------------
          //----------------------------------------------------------------------------------
          /* BEAKER PUZZLE*/
        
          
          var currentPickedBeaker = null;
          // In order to win
          var targetCompounds = ['Ammonia (NH3)'];
          var remainingAttempts = 3; // Number of attempts allowed


          // Register pickup listener component
          AFRAME.registerComponent('pickup-listener', {
              init: function () {
                  var el = this.el; // Current beaker element
                  var self = this; // Component instance
                
                  el.addEventListener('click', function () {
                      var currentBeakerId = el.getAttribute('id');
                      console.log('Beaker picked up:', currentBeakerId);
                    
                      // Retrieve the chemical type based on the current beaker ID
                      var chemicalType = getChemicalType(currentBeakerId);
                      console.log('Chemical type:', chemicalType);
                    
                      // If no beaker is currently picked up, pick up the clicked beaker
                      if (!currentPickedBeaker) {
                          currentPickedBeaker = currentBeakerId;
                      } else {
                          // If a beaker is already picked up, mix chemicals
                          if (currentPickedBeaker !== currentBeakerId) {
                              console.log('Mixing chemicals from', currentPickedBeaker, 'and', currentBeakerId);
                              mixChemicals(currentPickedBeaker, currentBeakerId);
                          } else {
                              console.log('Cannot pick up the same beaker twice.');
            
                          }
                          currentPickedBeaker = null; // Reset the currently picked-up beaker
                      }
                  });
            
              }
          });


          // Function to determine chemical type based on beaker ID
          function getChemicalType(beakerId) {
              switch (beakerId) {
                  case 'beaker1':
                      return 'hydrogen';
                  case 'beaker2':
                      return 'oxygen';
                  case 'beaker3':
                      return 'nitrogen';
                  default:
                      return '';
              }
          }


          // Function to mix chemicals from two beakers
          function mixChemicals(beaker1Id, beaker2Id) {
              var chemical1 = getChemicalType(beaker1Id);
              var chemical2 = getChemicalType(beaker2Id);
              console.log('Mixing chemicals from', beaker1Id, '(', chemical1, ') and', beaker2Id, '(', chemical2, ')');
            
              // store mixing
              var mixedChemical;


              // Check different combinations and perform corresponding mixing
              if ((chemical1 === 'hydrogen' && chemical2 === 'oxygen') || (chemical1 === 'oxygen' && chemical2 === 'hydrogen')) {
                  mixedChemical = 'Water (H2O)';
              } else if ((chemical1 === 'oxygen' && chemical2 === 'nitrogen') || (chemical1 === 'nitrogen' && chemical2 === 'oxygen')) {
                  mixedChemical = 'Nitrogen dioxide (NO2)';
              } else if ((chemical1 === 'hydrogen' && chemical2 === 'nitrogen') || (chemical1 === 'nitrogen' && chemical2 === 'hydrogen')) {
                  mixedChemical = 'Ammonia (NH3)';
              } else {
                  mixedChemical = 'Unknown';
              }


              console.log('Result of mixing:', mixedChemical);


              // Check if the mixed chemical matches any of the target compounds
              if (targetCompounds.includes(mixedChemical)) {
                  console.log('Congratulations! You have successfully created', mixedChemical, '. You win!');
                  // Choose a new random target compound if there are remaining attempts
                  if (remainingAttempts > 1) {
                      remainingAttempts--;
              
                  } else {
                      console.log('No more attempts remaining. Game over.');
                      // You can add further actions here for game over, like displaying a message or resetting the game
                  }
              
              }
          }




          // Add the component to each beaker using their IDs
          document.getElementById('beaker1').setAttribute('pickup-listener', '');
          document.getElementById('beaker2').setAttribute('pickup-listener', '');
          document.getElementById('beaker3').setAttribute('pickup-listener', '');


          //----------------------------------------------------------------------------------
          //----------------------------------------------------------------------------------
          //----------------------------------------------------------------------------------
          //COMPUTER PUZZLE
          document.addEventListener('keydown', function(event) {
            var passcode = "INNOVATE"; // Define your passcode here
            var inputText = document.querySelector('#passcodeInput').getAttribute('text').value;
          


            // Ignore non-alphanumeric keys except for Backspace
            if (!event.key.match(/^[a-zA-Z0-9]$/) && event.key !== "Backspace" && event.key !== "Enter") {
              return;
            }
          
            if (event.key !== "Enter") {
              // Append characters to passcode until Enter is pressed
              if (event.key === "Backspace") {
                passcode = inputText.slice(0, -1);
              } else {
                passcode = inputText + event.key;
              }
            } else {
              // Check if the entered passcode is correct
              if (inputText === passcode) {
                alert("Congratulations! You've entered the correct passcode.");
              } else {
                // Incorrect passcode, reset input field
                alert("Incorrect passcode. Please try again.");
                document.querySelector('#passcodeInput').setAttribute('text', 'value: Enter Passcode; color: #fff; width: 1.5; align: center; wrapCount: 15');
                passcode = "";
              }
            }
          
            // Update passcode input field text
            document.querySelector('#passcodeInput').setAttribute('text', 'value', passcode);
          
            // Update cursor position
            var cursorPositionX = passcode.length + 0.75;
            document.querySelector('#passcodeCursor').setAttribute('position', cursorPositionX + ' ' + cursorPositionY + ' -5');
          });


          AFRAME.registerComponent("click-log", {
                  init: function() {
                    this.myFunction = function() {
                      console.log("hi");
                    };


                    this.el.addEventListener("click", this.myFunction);
                  },


                  remove: function() {
                    this.el.removeEventListener("click", this.myFunction);
                  }
                });



        </script>
    
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>
  </body>
</html>
